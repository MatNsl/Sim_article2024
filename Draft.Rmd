---
title: "Draft"
output: html_document
date: "2024-06-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Draft

```{r}
# Tests (preliminaries)

# trees$cell2 <- 1*as.numeric((trees$x %in% seq(200, 300, by = .01)) & (trees$y %in% seq(200, 300, by = .01))) # Problem with 107th tree e.g.
# trees$cell <- 1*as.numeric((200 <= trees$x) & (trees$x < 300) & (200 <= trees$y) & (trees$y < 300))

# trees[trees$cell == 1 & trees$cell2 == 0,]
# Where is the pb?
# 297.21 %in% seq(233, 300, by = .01) # FALSE, idem for numbers below 233
# 297.21 %in% seq(234, 300, by = .01) # TRUE, idem for numbers above 234
```

```{r}
# Un peu long

# PROBLEME: ne garde que le 8 (i.e. le dernier nb)

trees$cell <- rep(0, 30942) # Initialisation de la variable

for (nb in 1:10){ # All the categories (to identify the cells)
for (ligne in 0:599){ # All the lines (en parcourant par rapport aux ordonnées)
  for(c in 1:60){ # En parcourant sur une même ligne
    # if (trees$cell == 0)
    trees$cell <- ifelse(
    # (trees$cell == 0) & 
      (vec[(nb-1)*60 + 1] <= trees$x) & (trees$x < vec[(nb-1)*60 + 1]+1) & (200+ligne <= trees$y) & (trees$y < 200+ligne+1), 
    list[nb], trees$cell)
  }

}
}

# (ligne-1)*trend + 
# (ligne-1)*trend + 
```


```{r}
# Un peu long

# PROBLEME: ne garde que le 8 (i.e. le dernier nb)

trees$cell <- rep(0, 30942) # Initialisation de la variable


for (ligne in 0:599){ # All the lines (en parcourant par rapport aux ordonnées)
  # for(c in 1:60){ # En parcourant sur une même ligne
    for (nb in 1:10){ # All the categories (to identify the cells)
    # if (trees$cell == 0)
    trees$cell <- ifelse(
    # (trees$cell == 0) & 
      (vec[(nb-1)*60 + 1] <= trees$x) & (trees$x < vec[(nb-1)*60 + 1]+1) & (200+ligne <= trees$y) & (trees$y < 200+ligne+1), 
    list[nb], trees$cell)
  }

# }
}
```

```{r}
unique(trees$cell)
```

```{r}
trees$cell3 <- rep(0, 30942)
trees$cell3 <- ifelse(
  (vec[1] <= trees$x) & (trees$x < vec[1]+1) & (vec[1] <= trees$y) & (trees$y < vec[1]+1), 
  1, trees$cell3)
```

```{r}
# Inaccurate cell
trees$cell3 <- ifelse(
  (200 <= trees$x) & (trees$x < 300) & (200 <= trees$y) & (trees$y < 300), 
  1, trees$cell3)
```

```{r}
# Invalid
trees$cell3 <- rep(0, 30942)
for (ligne in 1:60){
  
  for(l in 1:60){
    trees$cell3 <- ifelse(
    (vec[l] <= trees$x) & (trees$x < vec[l]+1) & (vec[1] <= trees$y) & (trees$y < vec[1]+1), 
    list[1], trees$cell3)
  }

}
```

```{r}
# When only focusing on 1 10th of the population
plot(x = trees[trees$cell3 == 9,]$x, y = trees[trees$cell3 == 9,]$y, main = "Forest", panel.first=grid())
# Pretty nice (at one point)
```

```{r}
# Test

trees$cell3 <- rep(0, 30942)
nb = 1
ligne = 0

for(c in 1:60){ # En parcourant sur une même ligne
    # if (trees$cell == 0)
    trees$cell <- ifelse(
    (vec[(c-1)*trend + (nb-1) + 1] <= trees$x) & (trees$x < vec[(c-1)*trend + nb]+1) & (200+ligne <= trees$y) & (trees$y < 200+ligne+1) & trees$cell, 
    list[nb], trees$cell)
  }
```

```{r}
# When only focusing on 1 10th of the population
plot(x = trees[trees$cell == 1,]$x, y = trees[trees$cell == 1,]$y, main = "Forest", panel.first=grid())
```

```{r}
# When only focusing on 
plot(x = trees[trees$cell == 9,]$x, y = trees[trees$cell == 9,]$y, main = "Forest", panel.first=grid())
```

```{r}
# When only focusing on 
plot(x = trees[trees$cell == 0,]$x, y = trees[trees$cell == 0,]$y, main = "Forest", panel.first=grid())
```

# Draft for part after 25 June

```{r}
fun_diag <- function(x,y){
  (x + y) <= 1000
}
```

```{r}
random_points$elt <- random_points$rho2/pi
```

```{r}
est_ratio2 <- sum(random_points$elt)
```

```{r}
integral2(fun_diag, 0, 1000, 0, 1000)
```

```{r}
integrate(function(y) {
  sapply(y, function(y){
    integrate(function(x){
      fun_ratio(x,y)}, 0, 1000)
    })
  }, 0, 1000)

```

# Draft for variance in No_cell.Rmd

```{r}
# var_est <- function(f){
#   random_points$carre <- (random_points$rho1)^2
#   est_carre <- sum((random_points$carre)/pi)
# }
```

# Draft for Trees_circle

```{r}
trees_in <- data.frame(useless = rep(0,30942))
col_names <- c()
for (point in 1:n) {
  new_col <- paste("point", point, sep = "")
  a <- random_points[point,]$x
  b <- random_points[point,]$y
  val <- is_point_in_circle(a, b, trees$x, trees$y, 100)*point
  # val <- is_point_in_circle(round(a, digits = 0), round(b, digits = 0), trees$x, trees$y, 100) #*point
  # if (val != 0){
  #  trees$Is_in_circle <- append(trees$Is_in_circle, val[val != 0])
  # }
  trees_in <- trees_in %>% add_column(new_col = val)
  col_names <- append(col_names, new_col)
}
# unique(trees$Is_in_circle)
trees_in[1] <- NULL
colnames(trees_in) <- col_names
```

```{r}
## Draft

nb_trees <- c()

for (placette in 1:n) {
  nb_trees <- append(nb_trees, sum(trees_in[trees_in$point74 != 0,]))
}

sum((nb_trees)/p)
# 28737017 # TOO MUCH, p is (probably) wrong
# 9.028e+09 # if p unchanged i.e. sum(rep((1/1000)*(1/1000), n))
# 57474033 # TOO MUCH, p is (probably) wrong if sum(rep((1/1000)*(1/1000)*((R^2)*pi)/2, n))
```

```{r}
trees$Is_in_circle <- is_point_in_circle(500, 500, trees$x, trees$y, 100)
unique(trees$Is_in_circle)
```

```{r}
# The sample thus obtained
trees[trees$Is_in_circle == TRUE,]
```

```{r}
total_trees <- nrow(trees[trees$Is_in_circle == TRUE,])
```

```{r}
trees$Is_in_circle <- is_point_in_circle(580.869189, 797.312061, trees$x, trees$y, 100)
unique(trees$Is_in_circle)
```


```{r}
# Marginal density: density of the uniform distribution over 1:1000
# Which leads us to the inclusion density function
p <- sum(rep((1/1000)*(1/1000), n)) # :(
# p

# I would say that p changes: area of each circle over total area for each marginal
# p <- sum(rep((1/1000)*(1/1000)*(R^2)*pi, n)) # :(

# p <- sum(rep((1/1000)*(1/1000)*((R^2)*pi)/2, n))
```





